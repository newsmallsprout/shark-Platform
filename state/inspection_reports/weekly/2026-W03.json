{
  "timestamp": "2026-01-13T01:12:29.421482Z",
  "prometheus_status": "ok",
  "down_targets": [],
  "firing_alerts": [],
  "metrics_summary": [
    {
      "category": "prometheus",
      "name": "targets_total",
      "display": "Targets Total",
      "labels": {},
      "value": 140,
      "unit": "count",
      "level": "ok",
      "status": "success",
      "query": ""
    },
    {
      "category": "prometheus",
      "name": "down_targets",
      "display": "Down Targets",
      "labels": {},
      "value": 0,
      "unit": "count",
      "level": "ok",
      "status": "success",
      "query": ""
    },
    {
      "category": "prometheus",
      "name": "alerts_total",
      "display": "Alerts Total",
      "labels": {},
      "value": 0,
      "unit": "count",
      "level": "ok",
      "status": "success",
      "query": ""
    },
    {
      "category": "prometheus",
      "name": "firing_alerts",
      "display": "Firing Alerts",
      "labels": {},
      "value": 0,
      "unit": "count",
      "level": "ok",
      "status": "success",
      "query": ""
    },
    {
      "category": "cpu",
      "name": "cpu_usage_top5",
      "display": "CPU Usage Top5",
      "labels": {
        "instance": "192.168.12.8:9100"
      },
      "value": 14.66,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)))"
    },
    {
      "category": "cpu",
      "name": "cpu_usage_top5",
      "display": "CPU Usage Top5",
      "labels": {
        "instance": "192.168.12.188:9100"
      },
      "value": 13.56,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)))"
    },
    {
      "category": "cpu",
      "name": "cpu_usage_top5",
      "display": "CPU Usage Top5",
      "labels": {
        "instance": "192.168.12.132:9100"
      },
      "value": 3.63,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)))"
    },
    {
      "category": "cpu",
      "name": "cpu_usage_top5",
      "display": "CPU Usage Top5",
      "labels": {
        "instance": "192.168.12.130:9100"
      },
      "value": 3.61,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)))"
    },
    {
      "category": "cpu",
      "name": "cpu_usage_top5",
      "display": "CPU Usage Top5",
      "labels": {
        "instance": "192.168.12.135:9100"
      },
      "value": 3.51,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (100 - (avg by (instance) (irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)))"
    },
    {
      "category": "memory",
      "name": "mem_usage_top5",
      "display": "Memory Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "instance": "192.168.12.145:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "name": "node-exporter"
      },
      "value": 56.67,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100)"
    },
    {
      "category": "memory",
      "name": "mem_usage_top5",
      "display": "Memory Usage Top5",
      "labels": {
        "instance": "192.168.12.93:9100",
        "job": "non-k8s-node-exporter"
      },
      "value": 51.83,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100)"
    },
    {
      "category": "memory",
      "name": "mem_usage_top5",
      "display": "Memory Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "instance": "192.168.12.142:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "name": "node-exporter"
      },
      "value": 40.54,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100)"
    },
    {
      "category": "memory",
      "name": "mem_usage_top5",
      "display": "Memory Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "instance": "192.168.12.130:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "name": "node-exporter"
      },
      "value": 38.78,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100)"
    },
    {
      "category": "memory",
      "name": "mem_usage_top5",
      "display": "Memory Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "instance": "192.168.12.132:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "name": "node-exporter"
      },
      "value": 38.25,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * 100)"
    },
    {
      "category": "disk",
      "name": "rootfs_usage_top5",
      "display": "Disk(/) Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "device": "/dev/mapper/cs-root",
        "fstype": "xfs",
        "instance": "192.168.12.140:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "mountpoint": "/",
        "name": "node-exporter"
      },
      "value": 48.52,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"})) * 100)"
    },
    {
      "category": "disk",
      "name": "rootfs_usage_top5",
      "display": "Disk(/) Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "device": "/dev/mapper/cs-root",
        "fstype": "xfs",
        "instance": "192.168.12.137:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "mountpoint": "/",
        "name": "node-exporter"
      },
      "value": 38.8,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"})) * 100)"
    },
    {
      "category": "disk",
      "name": "rootfs_usage_top5",
      "display": "Disk(/) Usage Top5",
      "labels": {
        "app": "node-exporter",
        "app_kubernetes_io_managed_by": "Helm",
        "device": "/dev/mapper/cs-root",
        "fstype": "xfs",
        "instance": "192.168.12.146:9100",
        "job": "kubernetes-service-endpoints",
        "kubernetes_name": "node-exporter",
        "kubernetes_namespace": "monitor",
        "mountpoint": "/",
        "name": "node-exporter"
      },
      "value": 30.85,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"})) * 100)"
    },
    {
      "category": "disk",
      "name": "rootfs_usage_top5",
      "display": "Disk(/) Usage Top5",
      "labels": {
        "device": "/dev/mapper/pve-root",
        "fstype": "ext4",
        "instance": "192.168.12.188:9100",
        "job": "non-k8s-node-exporter",
        "mountpoint": "/"
      },
      "value": 28.88,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"})) * 100)"
    },
    {
      "category": "disk",
      "name": "rootfs_usage_top5",
      "display": "Disk(/) Usage Top5",
      "labels": {
        "device": "/dev/mapper/pve-root",
        "fstype": "ext4",
        "instance": "192.168.12.8:9100",
        "job": "non-k8s-node-exporter",
        "mountpoint": "/"
      },
      "value": 27.83,
      "unit": "%",
      "level": "ok",
      "status": "success",
      "query": "topk(5, (1 - (node_filesystem_avail_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype!~\"tmpfs|overlay\"})) * 100)"
    }
  ],
  "ai_analysis": "# 巡检数据风险评估报告\n\n## 1. 总体概况\n- **巡检时间戳**: 2026-01-13T01:12:29.421482Z  \n- **风险评分**: 0.0（等级：正常）  \n- **关键特征**:  \n  - 140个监控目标全部在线，无离线情况；  \n  - 无活跃告警事件；  \n  - 最高资源使用率为内存（~56.67%），处于安全阈值内；  \n- **整体状态**: 系统运行稳定，无即时风险。\n\n\n## 2. 基础设施健康度\n- **监控系统状态**: Prometheus服务正常（状态：ok），数据采集能力完好；  \n- **目标可达性**: 所有140个监控目标均可达（离线目标数：0），无监控盲区；  \n- **告警系统有效性**: 无触发中的告警事件（活跃告警数：0），说明基础设施无异常运行迹象；  \n- **健康度结论**: 基础设施组件（监控、目标、告警）均处于健康状态。\n\n\n## 3. 资源与容量分析\n### 3.1 CPU资源\n- **Top5使用率**: 14.66%、13.56%、3.63%、3.61%、3.51%；  \n- **分析**: 最高CPU使用率不足15%，远低于常规警戒阈值（如70%），CPU资源处于低负载状态，具备充足扩容空间。\n\n### 3.2 内存资源\n- **Top5使用率**:56.67%、51.83%、40.54%、38.78%、38.25%；  \n- **分析**: 最高内存使用率约56.7%，处于安全区间（通常建议警戒阈值为80%），内存容量充足，无内存瓶颈风险。\n\n###3.3 存储资源\n- **Top5根分区使用率**:48.52%、38.8%、30.85%、28.88%、27.83%；  \n- **分析**: 最高存储使用率不足50%，剩余空间充足，无存储耗尽风险。\n\n###3.4 容量结论\n所有资源维度均在安全范围内运行，无即时容量约束问题。\n\n\n##4. 实时告警\n- **当前活跃告警**: 无（空列表）；  \n- **说明**: 暂无需要立即介入的异常事件。\n\n\n##5. 处置建议\n1. **持续监控**: 保持现有监控配置，确保后续巡检能及时发现资源波动或异常；  \n2. **基线建立**: 将本次资源使用率（如CPU均值、内存峰值）作为基准，后续巡检对比偏差，快速识别异常；  \n3. **资源优化（可选）**: 鉴于CPU使用率较低，可评估是否对低负载节点进行工作负载整合，提升资源利用率（非紧急）；  \n4. **安全强化**: 定期对所有监控组件执行漏洞扫描，提前防范潜在安全风险。\n\n\n##6. 漏洞关注\n无法确定，不做臆测。根据官方披露的来进行报告。如果无明确漏洞信息，请直接输出该段文字。",
  "report_id": "2026-01-13",
  "risk_summary": {
    "score": 0.0,
    "level": "ok",
    "reasons": [
      "resource_max=56.7%"
    ]
  },
  "compare_with_yesterday": {
    "yesterday_id": "2026-01-12",
    "delta": {
      "risk_score": 0.0,
      "down_targets": 0,
      "firing_alerts": 0
    }
  },
  "forecast_7_15_30": {
    "predictions": {
      "7d": {
        "risk_score": 100.0
      },
      "15d": {
        "risk_score": 100.0
      },
      "30d": {
        "risk_score": 100.0
      }
    }
  },
  "weekly_report_id": "2026-W03",
  "monthly_report_id": "2026-01"
}